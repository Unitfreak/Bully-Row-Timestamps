<!DOCTYPE html>
<html>
<head>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 80vh;
            margin: 0;
            padding: 0;
            flex-direction: column;
        }

        h2 {
            color: #444;
        }

        h1 {
            color: #666;
        }
        a {
            color: #0066cc;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        .timezone-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 20px;
        }

        .timezone-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .timezone-item label {
            margin-right: 10px;
        }
        
        #user-time-input {
            display: none; /* Hidden by default */
        }
    </style>
</head>

<body onload="initTimestamps()">

  <h2>Bully Timestamp:

  <select id="bullytime">
    <option value="1">+ Seconds</option>
    <option value="2">+ Percent</option>
    <option value="3">+ Timepan</option>
    <option value="4">+ Hex</option>
  </select>

  <select id="time-mode-select">
    <option value="current">Current Time</option>
    <option value="user-selected">User Selected Time</option>
  </select>

  </h2>

  <div id="txt">Calculating...</div>
  <input type="datetime-local" id="user-time-input" step="0.1">

  <div class="timezone-container">
      <h3>Compare Timezones:</h3>
      <div id="timezone-displays"></div>
  </div>
  
  <a href="https://en.m.wikiversity.org/wiki/Bully_Timestamps" style="padding-top: 15px;">Learn how it works!</a>
	
  <script>
  const bullysellect = document.getElementById("bullytime");
  const timeModeSelect = document.getElementById("time-mode-select");
  const userTimeInput = document.getElementById("user-time-input");
  let animationFrameId = null; // Use for requestAnimationFrame
  const TT_TAI_OFFSET_MILLISECONDS = 32184; // Constant offset between TT and TAI
      
  const leapSeconds = [
   new Date("1972-01-01T00:00:00Z"),
   new Date("1972-07-01T00:00:00Z"),
   new Date("1973-01-01T00:00:00Z"),
   new Date("1974-01-01T00:00:00Z"),
   new Date("1975-01-01T00:00:00Z"),
   new Date("1976-01-01T00:00:00Z"),
   new Date("1977-01-01T00:00:00Z"),
   new Date("1978-01-01T00:00:00Z"),
   new Date("1979-01-01T00:00:00Z"),
   new Date("1980-01-01T00:00:00Z"),
   new Date("1981-07-01T00:00:00Z"),
   new Date("1982-07-01T00:00:00Z"),
   new Date("1983-07-01T00:00:00Z"),
   new Date("1985-07-01T00:00:00Z"),
   new Date("1988-01-01T00:00:00Z"),
   new Date("1990-01-01T00:00:00Z"),
   new Date("1991-01-01T00:00:00Z"),
   new Date("1992-07-01T00:00:00Z"),
   new Date("1993-07-01T00:00:00Z"),
   new Date("1994-07-01T00:00:00Z"),
   new Date("1996-01-01T00:00:00Z"),
   new Date("1997-07-01T00:00:00Z"),
   new Date("1999-01-01T00:00:00Z"),
   new Date("2006-01-01T00:00:00Z"),
   new Date("2009-01-01T00:00:00Z"),
   new Date("2012-07-01T00:00:00Z"),
   new Date("2015-07-01T00:00:00Z"),
   new Date("2017-01-01T00:00:00Z"),
  ];
  const rubberSeconds = [
   new Date("1958-01-01T00:00:00Z"),
   new Date("1960-01-01T00:00:00Z"),
   new Date("1961-01-01T00:00:00Z"),
   new Date("1961-01-01T00:00:00.001Z"),
   new Date("1961-08-01T00:00:00Z"),
   new Date("1961-08-01T00:00:00.001Z"),
   new Date("1962-01-01T00:00:00Z"),
   new Date("1963-11-01T00:00:00Z"),
   new Date("1963-11-01T00:00:00.001Z"),
   new Date("1964-01-01T00:00:00Z"),
   new Date("1964-04-01T00:00:00Z"),
   new Date("1964-04-01T00:00:00.001Z"),
   new Date("1964-09-01T00:00:00Z"),
   new Date("1964-09-01T00:00:00.001Z"),
   new Date("1965-01-01T00:00:00Z"),
   new Date("1965-01-01T00:00:00.001Z"),
   new Date("1965-03-01T00:00:00Z"),
   new Date("1965-03-01T00:00:00.001Z"),
   new Date("1965-07-01T00:00:00Z"),
   new Date("1965-07-01T00:00:00.001Z"),
   new Date("1965-09-01T00:00:00Z"),
   new Date("1965-09-01T00:00:00.001Z"),
   new Date("1966-01-01T00:00:00Z"),
   new Date("1968-02-01T00:00:00Z"),
   new Date("1968-02-01T00:00:00.001Z"),
   new Date("1972-01-01T00:00:00Z"),
  ];
  const rubberValues = [
    -0.002598,
     0.943482,
     1.417818,
     1.422818,
     1.69757,
     1.64757,
     1.845858,
     2.5972788,
     2.6972788,
     2.765794,
     2.88373,
     2.98373,
     3.182018,
     3.282018,
     3.44013,
     3.54013,
     3.616594,
     3.716594,
     3.874706,
     3.974706,
     4.055058,
     4.155058,
     4.31317,
     6.285682,
     6.185682,
     9.892242,
  ];   
  const historicSeconds = [
   new Date("1657-01-01T00:00:00Z"),
   new Date("1657-06-01T00:00:00Z"),
   new Date("1658-01-01T00:00:00Z"),
   new Date("1658-06-01T00:00:00Z"),
   new Date("1659-01-01T00:00:00Z"),
   new Date("1659-06-01T00:00:00Z"),
   new Date("1660-01-01T00:00:00Z"),
   new Date("1660-06-01T00:00:00Z"),
   new Date("1661-01-01T00:00:00Z"),
   new Date("1661-06-01T00:00:00Z"),
   new Date("1662-01-01T00:00:00Z"),
   new Date("1662-06-01T00:00:00Z"),
   new Date("1663-01-01T00:00:00Z"),
   new Date("1663-06-01T00:00:00Z"),
   new Date("1664-01-01T00:00:00Z"),
   new Date("1664-06-01T00:00:00Z"),
   new Date("1665-01-01T00:00:00Z"),
   new Date("1665-06-01T00:00:00Z"),
   new Date("1666-01-01T00:00:00Z"),
   new Date("1666-06-01T00:00:00Z"),
   new Date("1667-01-01T00:00:00Z"),
   new Date("1667-06-01T00:00:00Z"),
   new Date("1668-01-01T00:00:00Z"),
   new Date("1668-06-01T00:00:00Z"),
   new Date("1669-01-01T00:00:00Z"),
   new Date("1669-06-01T00:00:00Z"),
   new Date("1670-01-01T00:00:00Z"),
   new Date("1670-06-01T00:00:00Z"),
   new Date("1671-01-01T00:00:00Z"),
   new Date("1671-06-01T00:00:00Z"),
   new Date("1672-01-01T00:00:00Z"),
   new Date("1672-06-01T00:00:00Z"),
   new Date("1673-01-01T00:00:00Z"),
   new Date("1673-06-01T00:00:00Z"),
   new Date("1674-01-01T00:00:00Z"),
   new Date("1674-06-01T00:00:00Z"),
   new Date("1675-01-01T00:00:00Z"),
   new Date("1675-06-01T00:00:00Z"),
   new Date("1676-01-01T00:00:00Z"),
   new Date("1676-06-01T00:00:00Z"),
   new Date("1677-01-01T00:00:00Z"),
   new Date("1677-06-01T00:00:00Z"),
   new Date("1678-01-01T00:00:00Z"),
   new Date("1678-06-01T00:00:00Z"),
   new Date("1679-01-01T00:00:00Z"),
   new Date("1679-06-01T00:00:00Z"),
   new Date("1680-01-01T00:00:00Z"),
   new Date("1680-06-01T00:00:00Z"),
   new Date("1681-01-01T00:00:00Z"),
   new Date("1681-06-01T00:00:00Z"),
   new Date("1682-01-01T00:00:00Z"),
   new Date("1682-06-01T00:00:00Z"),
   new Date("1683-01-01T00:00:00Z"),
   new Date("1683-06-01T00:00:00Z"),
   new Date("1684-01-01T00:00:00Z"),
   new Date("1684-06-01T00:00:00Z"),
   new Date("1685-01-01T00:00:00Z"),
   new Date("1685-06-01T00:00:00Z"),
   new Date("1686-01-01T00:00:00Z"),
   new Date("1686-06-01T00:00:00Z"),
   new Date("1687-01-01T00:00:00Z"),
   new Date("1687-06-01T00:00:00Z"),
   new Date("1688-01-01T00:00:00Z"),
   new Date("1688-06-01T00:00:00Z"),
   new Date("1689-01-01T00:00:00Z"),
   new Date("1689-06-01T00:00:00Z"),
   new Date("1690-01-01T00:00:00Z"),
   new Date("1690-06-01T00:00:00Z"),
   new Date("1691-01-01T00:00:00Z"),
   new Date("1691-06-01T00:00:00Z"),
   new Date("1692-01-01T00:00:00Z"),
   new Date("1692-06-01T00:00:00Z"),
   new Date("1693-01-01T00:00:00Z"),
   new Date("1693-06-01T00:00:00Z"),
   new Date("1694-01-01T00:00:00Z"),
   new Date("1694-06-01T00:00:00Z"),
   new Date("1695-01-01T00:00:00Z"),
   new Date("1695-06-01T00:00:00Z"),
   new Date("1696-01-01T00:00:00Z"),
   new Date("1696-06-01T00:00:00Z"),
   new Date("1697-01-01T00:00:00Z"),
   new Date("1697-06-01T00:00:00Z"),
   new Date("1698-01-01T00:00:00Z"),
   new Date("1698-06-01T00:00:00Z"),
   new Date("1699-01-01T00:00:00Z"),
   new Date("1699-06-01T00:00:00Z"),
   new Date("1700-01-01T00:00:00Z"),
   new Date("1700-06-01T00:00:00Z"),
   new Date("1701-01-01T00:00:00Z"),
   new Date("1701-06-01T00:00:00Z"),
   new Date("1702-01-01T00:00:00Z"),
   new Date("1702-06-01T00:00:00Z"),
   new Date("1703-01-01T00:00:00Z"),
   new Date("1703-06-01T00:00:00Z"),
   new Date("1704-01-01T00:00:00Z"),
   new Date("1704-06-01T00:00:00Z"),
   new Date("1705-01-01T00:00:00Z"),
   new Date("1705-06-01T00:00:00Z"),
   new Date("1706-01-01T00:00:00Z"),
   new Date("1706-06-01T00:00:00Z"),
   new Date("1707-01-01T00:00:00Z"),
   new Date("1707-06-01T00:00:00Z"),
   new Date("1708-01-01T00:00:00Z"),
   new Date("1708-06-01T00:00:00Z"),
   new Date("1709-01-01T00:00:00Z"),
   new Date("1709-06-01T00:00:00Z"),
   new Date("1710-01-01T00:00:00Z"),
   new Date("1710-06-01T00:00:00Z"),
   new Date("1711-01-01T00:00:00Z"),
   new Date("1711-06-01T00:00:00Z"),
   new Date("1712-01-01T00:00:00Z"),
   new Date("1712-06-01T00:00:00Z"),
   new Date("1713-01-01T00:00:00Z"),
   new Date("1713-06-01T00:00:00Z"),
   new Date("1714-01-01T00:00:00Z"),
   new Date("1714-06-01T00:00:00Z"),
   new Date("1715-01-01T00:00:00Z"),
   new Date("1715-06-01T00:00:00Z"),
   new Date("1716-01-01T00:00:00Z"),
   new Date("1716-06-01T00:00:00Z"),
   new Date("1717-01-01T00:00:00Z"),
   new Date("1717-06-01T00:00:00Z"),
   new Date("1718-01-01T00:00:00Z"),
   new Date("1718-06-01T00:00:00Z"),
   new Date("1719-01-01T00:00:00Z"),
   new Date("1719-06-01T00:00:00Z"),
   new Date("1720-01-01T00:00:00Z"),
   new Date("1720-06-01T00:00:00Z"),
   new Date("1721-01-01T00:00:00Z"),
   new Date("1721-06-01T00:00:00Z"),
   new Date("1722-01-01T00:00:00Z"),
   new Date("1722-06-01T00:00:00Z"),
   new Date("1723-01-01T00:00:00Z"),
   new Date("1723-06-01T00:00:00Z"),
   new Date("1724-01-01T00:00:00Z"),
   new Date("1724-06-01T00:00:00Z"),
   new Date("1725-01-01T00:00:00Z"),
   new Date("1725-06-01T00:00:00Z"),
   new Date("1726-01-01T00:00:00Z"),
   new Date("1726-06-01T00:00:00Z"),
   new Date("1727-01-01T00:00:00Z"),
   new Date("1727-06-01T00:00:00Z"),
   new Date("1728-01-01T00:00:00Z"),
   new Date("1728-06-01T00:00:00Z"),
   new Date("1729-01-01T00:00:00Z"),
   new Date("1729-06-01T00:00:00Z"),
   new Date("1730-01-01T00:00:00Z"),
   new Date("1730-06-01T00:00:00Z"),
   new Date("1731-01-01T00:00:00Z"),
   new Date("1731-06-01T00:00:00Z"),
   new Date("1732-01-01T00:00:00Z"),
   new Date("1732-06-01T00:00:00Z"),
   new Date("1733-01-01T00:00:00Z"),
   new Date("1733-06-01T00:00:00Z"),
   new Date("1734-01-01T00:00:00Z"),
   new Date("1734-06-01T00:00:00Z"),
   new Date("1735-01-01T00:00:00Z"),
   new Date("1735-06-01T00:00:00Z"),
   new Date("1736-01-01T00:00:00Z"),
   new Date("1736-06-01T00:00:00Z"),
   new Date("1737-01-01T00:00:00Z"),
   new Date("1737-06-01T00:00:00Z"),
   new Date("1738-01-01T00:00:00Z"),
   new Date("1738-06-01T00:00:00Z"),
   new Date("1739-01-01T00:00:00Z"),
   new Date("1739-06-01T00:00:00Z"),
   new Date("1740-01-01T00:00:00Z"),
   new Date("1740-06-01T00:00:00Z"),
   new Date("1741-01-01T00:00:00Z"),
   new Date("1741-06-01T00:00:00Z"),
   new Date("1742-01-01T00:00:00Z"),
   new Date("1742-06-01T00:00:00Z"),
   new Date("1743-01-01T00:00:00Z"),
   new Date("1743-06-01T00:00:00Z"),
   new Date("1744-01-01T00:00:00Z"),
   new Date("1744-06-01T00:00:00Z"),
   new Date("1745-01-01T00:00:00Z"),
   new Date("1745-06-01T00:00:00Z"),
   new Date("1746-01-01T00:00:00Z"),
   new Date("1746-06-01T00:00:00Z"),
   new Date("1747-01-01T00:00:00Z"),
   new Date("1747-06-01T00:00:00Z"),
   new Date("1748-01-01T00:00:00Z"),
   new Date("1748-06-01T00:00:00Z"),
   new Date("1749-01-01T00:00:00Z"),
   new Date("1749-06-01T00:00:00Z"),
   new Date("1750-01-01T00:00:00Z"),
   new Date("1750-06-01T00:00:00Z"),
   new Date("1751-01-01T00:00:00Z"),
   new Date("1751-06-01T00:00:00Z"),
   new Date("1752-01-01T00:00:00Z"),
   new Date("1752-06-01T00:00:00Z"),
   new Date("1753-01-01T00:00:00Z"),
   new Date("1753-06-01T00:00:00Z"),
   new Date("1754-01-01T00:00:00Z"),
   new Date("1754-06-01T00:00:00Z"),
   new Date("1755-01-01T00:00:00Z"),
   new Date("1755-06-01T00:00:00Z"),
   new Date("1756-01-01T00:00:00Z"),
   new Date("1756-06-01T00:00:00Z"),
   new Date("1757-01-01T00:00:00Z"),
   new Date("1757-06-01T00:00:00Z"),
   new Date("1758-01-01T00:00:00Z"),
   new Date("1758-06-01T00:00:00Z"),
   new Date("1759-01-01T00:00:00Z"),
   new Date("1759-06-01T00:00:00Z"),
   new Date("1760-01-01T00:00:00Z"),
   new Date("1760-06-01T00:00:00Z"),
   new Date("1761-01-01T00:00:00Z"),
   new Date("1761-06-01T00:00:00Z"),
   new Date("1762-01-01T00:00:00Z"),
   new Date("1762-06-01T00:00:00Z"),
   new Date("1763-01-01T00:00:00Z"),
   new Date("1763-06-01T00:00:00Z"),
   new Date("1764-01-01T00:00:00Z"),
   new Date("1764-06-01T00:00:00Z"),
   new Date("1765-01-01T00:00:00Z"),
   new Date("1765-06-01T00:00:00Z"),
   new Date("1766-01-01T00:00:00Z"),
   new Date("1766-06-01T00:00:00Z"),
   new Date("1767-01-01T00:00:00Z"),
   new Date("1767-06-01T00:00:00Z"),
   new Date("1768-01-01T00:00:00Z"),
   new Date("1768-06-01T00:00:00Z"),
   new Date("1769-01-01T00:00:00Z"),
   new Date("1769-06-01T00:00:00Z"),
   new Date("1770-01-01T00:00:00Z"),
   new Date("1770-06-01T00:00:00Z"),
   new Date("1771-01-01T00:00:00Z"),
   new Date("1771-06-01T00:00:00Z"),
   new Date("1772-01-01T00:00:00Z"),
   new Date("1772-06-01T00:00:00Z"),
   new Date("1773-01-01T00:00:00Z"),
   new Date("1773-06-01T00:00:00Z"),
   new Date("1774-01-01T00:00:00Z"),
   new Date("1774-06-01T00:00:00Z"),
   new Date("1775-01-01T00:00:00Z"),
   new Date("1775-06-01T00:00:00Z"),
   new Date("1776-01-01T00:00:00Z"),
   new Date("1776-06-01T00:00:00Z"),
   new Date("1777-01-01T00:00:00Z"),
   new Date("1777-06-01T00:00:00Z"),
   new Date("1778-01-01T00:00:00Z"),
   new Date("1778-06-01T00:00:00Z"),
   new Date("1779-01-01T00:00:00Z"),
   new Date("1779-06-01T00:00:00Z"),
   new Date("1780-01-01T00:00:00Z"),
   new Date("1780-06-01T00:00:00Z"),
   new Date("1781-01-01T00:00:00Z"),
   new Date("1781-06-01T00:00:00Z"),
   new Date("1782-01-01T00:00:00Z"),
   new Date("1782-06-01T00:00:00Z"),
   new Date("1783-01-01T00:00:00Z"),
   new Date("1783-06-01T00:00:00Z"),
   new Date("1784-01-01T00:00:00Z"),
   new Date("1784-06-01T00:00:00Z"),
   new Date("1785-01-01T00:00:00Z"),
   new Date("1785-06-01T00:00:00Z"),
   new Date("1786-01-01T00:00:00Z"),
   new Date("1786-06-01T00:00:00Z"),
   new Date("1787-01-01T00:00:00Z"),
   new Date("1787-06-01T00:00:00Z"),
   new Date("1788-01-01T00:00:00Z"),
   new Date("1788-06-01T00:00:00Z"),
   new Date("1789-01-01T00:00:00Z"),
   new Date("1789-06-01T00:00:00Z"),
   new Date("1790-01-01T00:00:00Z"),
   new Date("1790-06-01T00:00:00Z"),
   new Date("1791-01-01T00:00:00Z"),
   new Date("1791-06-01T00:00:00Z"),
   new Date("1792-01-01T00:00:00Z"),
   new Date("1792-06-01T00:00:00Z"),
   new Date("1793-01-01T00:00:00Z"),
   new Date("1793-06-01T00:00:00Z"),
   new Date("1794-01-01T00:00:00Z"),
   new Date("1794-06-01T00:00:00Z"),
   new Date("1795-01-01T00:00:00Z"),
   new Date("1795-06-01T00:00:00Z"),
   new Date("1796-01-01T00:00:00Z"),
   new Date("1796-06-01T00:00:00Z"),
   new Date("1797-01-01T00:00:00Z"),
   new Date("1797-06-01T00:00:00Z"),
   new Date("1798-01-01T00:00:00Z"),
   new Date("1798-06-01T00:00:00Z"),
   new Date("1799-01-01T00:00:00Z"),
   new Date("1799-06-01T00:00:00Z"),
   new Date("1800-01-01T00:00:00Z"),
   new Date("1800-06-01T00:00:00Z"),
   new Date("1801-01-01T00:00:00Z"),
   new Date("1801-06-01T00:00:00Z"),
   new Date("1802-01-01T00:00:00Z"),
   new Date("1802-06-01T00:00:00Z"),
   new Date("1803-01-01T00:00:00Z"),
   new Date("1803-06-01T00:00:00Z"),
   new Date("1804-01-01T00:00:00Z"),
   new Date("1804-06-01T00:00:00Z"),
   new Date("1805-01-01T00:00:00Z"),
   new Date("1805-06-01T00:00:00Z"),
   new Date("1806-01-01T00:00:00Z"),
   new Date("1806-06-01T00:00:00Z"),
   new Date("1807-01-01T00:00:00Z"),
   new Date("1807-06-01T00:00:00Z"),
   new Date("1808-01-01T00:00:00Z"),
   new Date("1808-06-01T00:00:00Z"),
   new Date("1809-01-01T00:00:00Z"),
   new Date("1809-06-01T00:00:00Z"),
   new Date("1810-01-01T00:00:00Z"),
   new Date("1810-06-01T00:00:00Z"),
   new Date("1811-01-01T00:00:00Z"),
   new Date("1811-06-01T00:00:00Z"),
   new Date("1812-01-01T00:00:00Z"),
   new Date("1812-06-01T00:00:00Z"),
   new Date("1813-01-01T00:00:00Z"),
   new Date("1813-06-01T00:00:00Z"),
   new Date("1814-01-01T00:00:00Z"),
   new Date("1814-06-01T00:00:00Z"),
   new Date("1815-01-01T00:00:00Z"),
   new Date("1815-06-01T00:00:00Z"),
   new Date("1816-01-01T00:00:00Z"),
   new Date("1816-06-01T00:00:00Z"),
   new Date("1817-01-01T00:00:00Z"),
   new Date("1817-06-01T00:00:00Z"),
   new Date("1818-01-01T00:00:00Z"),
   new Date("1818-06-01T00:00:00Z"),
   new Date("1819-01-01T00:00:00Z"),
   new Date("1819-06-01T00:00:00Z"),
   new Date("1820-01-01T00:00:00Z"),
   new Date("1820-06-01T00:00:00Z"),
   new Date("1821-01-01T00:00:00Z"),
   new Date("1821-06-01T00:00:00Z"),
   new Date("1822-01-01T00:00:00Z"),
   new Date("1822-06-01T00:00:00Z"),
   new Date("1823-01-01T00:00:00Z"),
   new Date("1823-06-01T00:00:00Z"),
   new Date("1824-01-01T00:00:00Z"),
   new Date("1824-06-01T00:00:00Z"),
   new Date("1825-01-01T00:00:00Z"),
   new Date("1825-06-01T00:00:00Z"),
   new Date("1826-01-01T00:00:00Z"),
   new Date("1826-06-01T00:00:00Z"),
   new Date("1827-01-01T00:00:00Z"),
   new Date("1827-06-01T00:00:00Z"),
   new Date("1828-01-01T00:00:00Z"),
   new Date("1828-06-01T00:00:00Z"),
   new Date("1829-01-01T00:00:00Z"),
   new Date("1829-06-01T00:00:00Z"),
   new Date("1830-01-01T00:00:00Z"),
   new Date("1830-06-01T00:00:00Z"),
   new Date("1831-01-01T00:00:00Z"),
   new Date("1831-06-01T00:00:00Z"),
   new Date("1832-01-01T00:00:00Z"),
   new Date("1832-06-01T00:00:00Z"),
   new Date("1833-01-01T00:00:00Z"),
   new Date("1833-06-01T00:00:00Z"),
   new Date("1834-01-01T00:00:00Z"),
   new Date("1834-06-01T00:00:00Z"),
   new Date("1835-01-01T00:00:00Z"),
   new Date("1835-06-01T00:00:00Z"),
   new Date("1836-01-01T00:00:00Z"),
   new Date("1836-06-01T00:00:00Z"),
   new Date("1837-01-01T00:00:00Z"),
   new Date("1837-06-01T00:00:00Z"),
   new Date("1838-01-01T00:00:00Z"),
   new Date("1838-06-01T00:00:00Z"),
   new Date("1839-01-01T00:00:00Z"),
   new Date("1839-06-01T00:00:00Z"),
   new Date("1840-01-01T00:00:00Z"),
   new Date("1840-06-01T00:00:00Z"),
   new Date("1841-01-01T00:00:00Z"),
   new Date("1841-06-01T00:00:00Z"),
   new Date("1842-01-01T00:00:00Z"),
   new Date("1842-06-01T00:00:00Z"),
   new Date("1843-01-01T00:00:00Z"),
   new Date("1843-06-01T00:00:00Z"),
   new Date("1844-01-01T00:00:00Z"),
   new Date("1844-06-01T00:00:00Z"),
   new Date("1845-01-01T00:00:00Z"),
   new Date("1845-06-01T00:00:00Z"),
   new Date("1846-01-01T00:00:00Z"),
   new Date("1846-06-01T00:00:00Z"),
   new Date("1847-01-01T00:00:00Z"),
   new Date("1847-06-01T00:00:00Z"),
   new Date("1848-01-01T00:00:00Z"),
   new Date("1848-06-01T00:00:00Z"),
   new Date("1849-01-01T00:00:00Z"),
   new Date("1849-06-01T00:00:00Z"),
   new Date("1850-01-01T00:00:00Z"),
   new Date("1850-06-01T00:00:00Z"),
   new Date("1851-01-01T00:00:00Z"),
   new Date("1851-06-01T00:00:00Z"),
   new Date("1852-01-01T00:00:00Z"),
   new Date("1852-06-01T00:00:00Z"),
   new Date("1853-01-01T00:00:00Z"),
   new Date("1853-06-01T00:00:00Z"),
   new Date("1854-01-01T00:00:00Z"),
   new Date("1854-06-01T00:00:00Z"),
   new Date("1855-01-01T00:00:00Z"),
   new Date("1855-06-01T00:00:00Z"),
   new Date("1856-01-01T00:00:00Z"),
   new Date("1856-06-01T00:00:00Z"),
   new Date("1857-01-01T00:00:00Z"),
   new Date("1857-06-01T00:00:00Z"),
   new Date("1858-01-01T00:00:00Z"),
   new Date("1858-06-01T00:00:00Z"),
   new Date("1859-01-01T00:00:00Z"),
   new Date("1859-06-01T00:00:00Z"),
   new Date("1860-01-01T00:00:00Z"),
   new Date("1860-06-01T00:00:00Z"),
   new Date("1861-01-01T00:00:00Z"),
   new Date("1861-06-01T00:00:00Z"),
   new Date("1862-01-01T00:00:00Z"),
   new Date("1862-06-01T00:00:00Z"),
   new Date("1863-01-01T00:00:00Z"),
   new Date("1863-06-01T00:00:00Z"),
   new Date("1864-01-01T00:00:00Z"),
   new Date("1864-06-01T00:00:00Z"),
   new Date("1865-01-01T00:00:00Z"),
   new Date("1865-06-01T00:00:00Z"),
   new Date("1866-01-01T00:00:00Z"),
   new Date("1866-06-01T00:00:00Z"),
   new Date("1867-01-01T00:00:00Z"),
   new Date("1867-06-01T00:00:00Z"),
   new Date("1868-01-01T00:00:00Z"),
   new Date("1868-06-01T00:00:00Z"),
   new Date("1869-01-01T00:00:00Z"),
   new Date("1869-06-01T00:00:00Z"),
   new Date("1870-01-01T00:00:00Z"),
   new Date("1870-06-01T00:00:00Z"),
   new Date("1871-01-01T00:00:00Z"),
   new Date("1871-06-01T00:00:00Z"),
   new Date("1872-01-01T00:00:00Z"),
   new Date("1872-06-01T00:00:00Z"),
   new Date("1873-01-01T00:00:00Z"),
   new Date("1873-06-01T00:00:00Z"),
   new Date("1874-01-01T00:00:00Z"),
   new Date("1874-06-01T00:00:00Z"),
   new Date("1875-01-01T00:00:00Z"),
   new Date("1875-06-01T00:00:00Z"),
   new Date("1876-01-01T00:00:00Z"),
   new Date("1876-06-01T00:00:00Z"),
   new Date("1877-01-01T00:00:00Z"),
   new Date("1877-06-01T00:00:00Z"),
   new Date("1878-01-01T00:00:00Z"),
   new Date("1878-06-01T00:00:00Z"),
   new Date("1879-01-01T00:00:00Z"),
   new Date("1879-06-01T00:00:00Z"),
   new Date("1880-01-01T00:00:00Z"),
   new Date("1880-06-01T00:00:00Z"),
   new Date("1881-01-01T00:00:00Z"),
   new Date("1881-06-01T00:00:00Z"),
   new Date("1882-01-01T00:00:00Z"),
   new Date("1882-06-01T00:00:00Z"),
   new Date("1883-01-01T00:00:00Z"),
   new Date("1883-06-01T00:00:00Z"),
   new Date("1884-01-01T00:00:00Z"),
   new Date("1884-06-01T00:00:00Z"),
   new Date("1885-01-01T00:00:00Z"),
   new Date("1885-06-01T00:00:00Z"),
   new Date("1886-01-01T00:00:00Z"),
   new Date("1886-06-01T00:00:00Z"),
   new Date("1887-01-01T00:00:00Z"),
   new Date("1887-06-01T00:00:00Z"),
   new Date("1888-01-01T00:00:00Z"),
   new Date("1888-06-01T00:00:00Z"),
   new Date("1889-01-01T00:00:00Z"),
   new Date("1889-06-01T00:00:00Z"),
   new Date("1890-01-01T00:00:00Z"),
   new Date("1890-06-01T00:00:00Z"),
   new Date("1891-01-01T00:00:00Z"),
   new Date("1891-06-01T00:00:00Z"),
   new Date("1892-01-01T00:00:00Z"),
   new Date("1892-06-01T00:00:00Z"),
   new Date("1893-01-01T00:00:00Z"),
   new Date("1893-06-01T00:00:00Z"),
   new Date("1894-01-01T00:00:00Z"),
   new Date("1894-06-01T00:00:00Z"),
   new Date("1895-01-01T00:00:00Z"),
   new Date("1895-06-01T00:00:00Z"),
   new Date("1896-01-01T00:00:00Z"),
   new Date("1896-06-01T00:00:00Z"),
   new Date("1897-01-01T00:00:00Z"),
   new Date("1897-06-01T00:00:00Z"),
   new Date("1898-01-01T00:00:00Z"),
   new Date("1898-06-01T00:00:00Z"),
   new Date("1899-01-01T00:00:00Z"),
   new Date("1899-06-01T00:00:00Z"),
   new Date("1900-01-01T00:00:00Z"),
   new Date("1900-06-01T00:00:00Z"),
   new Date("1901-01-01T00:00:00Z"),
   new Date("1901-06-01T00:00:00Z"),
   new Date("1902-01-01T00:00:00Z"),
   new Date("1902-06-01T00:00:00Z"),
   new Date("1903-01-01T00:00:00Z"),
   new Date("1903-06-01T00:00:00Z"),
   new Date("1904-01-01T00:00:00Z"),
   new Date("1904-06-01T00:00:00Z"),
   new Date("1905-01-01T00:00:00Z"),
   new Date("1905-06-01T00:00:00Z"),
   new Date("1906-01-01T00:00:00Z"),
   new Date("1906-06-01T00:00:00Z"),
   new Date("1907-01-01T00:00:00Z"),
   new Date("1907-06-01T00:00:00Z"),
   new Date("1908-01-01T00:00:00Z"),
   new Date("1908-06-01T00:00:00Z"),
   new Date("1909-01-01T00:00:00Z"),
   new Date("1909-06-01T00:00:00Z"),
   new Date("1910-01-01T00:00:00Z"),
   new Date("1910-06-01T00:00:00Z"),
   new Date("1911-01-01T00:00:00Z"),
   new Date("1911-06-01T00:00:00Z"),
   new Date("1912-01-01T00:00:00Z"),
   new Date("1912-06-01T00:00:00Z"),
   new Date("1913-01-01T00:00:00Z"),
   new Date("1913-06-01T00:00:00Z"),
   new Date("1914-01-01T00:00:00Z"),
   new Date("1914-06-01T00:00:00Z"),
   new Date("1915-01-01T00:00:00Z"),
   new Date("1915-06-01T00:00:00Z"),
   new Date("1916-01-01T00:00:00Z"),
   new Date("1916-06-01T00:00:00Z"),
   new Date("1917-01-01T00:00:00Z"),
   new Date("1917-06-01T00:00:00Z"),
   new Date("1918-01-01T00:00:00Z"),
   new Date("1918-06-01T00:00:00Z"),
   new Date("1919-01-01T00:00:00Z"),
   new Date("1919-06-01T00:00:00Z"),
   new Date("1920-01-01T00:00:00Z"),
   new Date("1920-06-01T00:00:00Z"),
   new Date("1921-01-01T00:00:00Z"),
   new Date("1921-06-01T00:00:00Z"),
   new Date("1922-01-01T00:00:00Z"),
   new Date("1922-06-01T00:00:00Z"),
   new Date("1923-01-01T00:00:00Z"),
   new Date("1923-06-01T00:00:00Z"),
   new Date("1924-01-01T00:00:00Z"),
   new Date("1924-06-01T00:00:00Z"),
   new Date("1925-01-01T00:00:00Z"),
   new Date("1925-06-01T00:00:00Z"),
   new Date("1926-01-01T00:00:00Z"),
   new Date("1926-06-01T00:00:00Z"),
   new Date("1927-01-01T00:00:00Z"),
   new Date("1927-06-01T00:00:00Z"),
   new Date("1928-01-01T00:00:00Z"),
   new Date("1928-06-01T00:00:00Z"),
   new Date("1929-01-01T00:00:00Z"),
   new Date("1929-06-01T00:00:00Z"),
   new Date("1930-01-01T00:00:00Z"),
   new Date("1930-06-01T00:00:00Z"),
   new Date("1931-01-01T00:00:00Z"),
   new Date("1931-06-01T00:00:00Z"),
   new Date("1932-01-01T00:00:00Z"),
   new Date("1932-06-01T00:00:00Z"),
   new Date("1933-01-01T00:00:00Z"),
   new Date("1933-06-01T00:00:00Z"),
   new Date("1934-01-01T00:00:00Z"),
   new Date("1934-06-01T00:00:00Z"),
   new Date("1935-01-01T00:00:00Z"),
   new Date("1935-06-01T00:00:00Z"),
   new Date("1936-01-01T00:00:00Z"),
   new Date("1936-06-01T00:00:00Z"),
   new Date("1937-01-01T00:00:00Z"),
   new Date("1937-06-01T00:00:00Z"),
   new Date("1938-01-01T00:00:00Z"),
   new Date("1938-06-01T00:00:00Z"),
   new Date("1939-01-01T00:00:00Z"),
   new Date("1939-06-01T00:00:00Z"),
   new Date("1940-01-01T00:00:00Z"),
   new Date("1940-06-01T00:00:00Z"),
   new Date("1941-01-01T00:00:00Z"),
   new Date("1941-06-01T00:00:00Z"),
   new Date("1942-01-01T00:00:00Z"),
   new Date("1942-06-01T00:00:00Z"),
   new Date("1943-01-01T00:00:00Z"),
   new Date("1943-06-01T00:00:00Z"),
   new Date("1944-01-01T00:00:00Z"),
   new Date("1944-06-01T00:00:00Z"),
   new Date("1945-01-01T00:00:00Z"),
   new Date("1945-06-01T00:00:00Z"),
   new Date("1946-01-01T00:00:00Z"),
   new Date("1946-06-01T00:00:00Z"),
   new Date("1947-01-01T00:00:00Z"),
   new Date("1947-06-01T00:00:00Z"),
   new Date("1948-01-01T00:00:00Z"),
   new Date("1948-06-01T00:00:00Z"),
   new Date("1949-01-01T00:00:00Z"),
   new Date("1949-06-01T00:00:00Z"),
   new Date("1950-01-01T00:00:00Z"),
   new Date("1950-06-01T00:00:00Z"),
   new Date("1951-01-01T00:00:00Z"),
   new Date("1951-06-01T00:00:00Z"),
   new Date("1952-01-01T00:00:00Z"),
   new Date("1952-06-01T00:00:00Z"),
   new Date("1953-01-01T00:00:00Z"),
   new Date("1953-06-01T00:00:00Z"),
   new Date("1954-01-01T00:00:00Z"),
   new Date("1954-06-01T00:00:00Z"),
   new Date("1955-01-01T00:00:00Z"),
   new Date("1955-06-01T00:00:00Z"),
   new Date("1956-01-01T00:00:00Z"),
   new Date("1956-06-01T00:00:00Z"),
   new Date("1957-01-01T00:00:00Z"),
   new Date("1957-06-01T00:00:00Z"),
   new Date("1958-01-01T00:00:00Z"),      
  ];
  const historicValues = [
      11.816,
      10.816,
      10.816,
      8.816,
      7.816,
      6.816,
      5.816,
      4.816,
      4.816,
      3.816,
      3.816,
      3.816,
      4.816,
      4.816,
      5.816,
      4.816,
      3.816,
      3.816,
      2.816,
      2.816,
      1.816,
      0.816,
      0.816,
      -0.184,
      -0.184,
      -1.184,
      -1.184,
      -2.184,
      -2.184,
      -3.184,
      -3.184,
      -3.184,
      -3.184,
      -3.184,
      -4.184,
      -4.184,
      -5.184,
      -5.184,
      -6.184,
      -6.184,
      -7.184,
      -7.184,
      -7.184,
      -6.184,
      -6.184,
      -6.184,
      -6.184,
      -7.184,
      -7.184,
      -7.184,
      -8.184,
      -8.184,
      -8.184,
      -8.184,
      -8.184,
      -8.184,
      -8.184,
      -8.184,
      -8.184,
      -8.184,
      -9.184,
      -9.184,
      -9.184,
      -9.184,
      -10.184,
      -10.184,
      -10.184,
      -10.184,
      -10.184,
      -11.184,
      -11.184,
      -11.184,
      -11.184,
      -11.184,
      -11.184,
      -11.184,
      -11.184,
      -12.184,
      -12.184,
      -12.184,
      -12.184,
      -12.184,
      -12.184,
      -12.184,
      -12.184,
      -12.184,
      -11.184,
      -11.184,
      -11.184,
      -12.184,
      -12.184,
      -12.184,
      -12.184,
      -12.184,
      -13.184,
      -13.184,
      -13.184,
      -13.184,
      -13.184,
      -12.184,
      -12.184,
      -12.184,
      -12.184,
      -13.184,
      -12.184,
      -12.184,
      -12.184,
      -12.184,
      -12.184,
      -12.184,
      -11.184,
      -11.184,
      -11.184,
      -11.184,
      -11.184,
      -11.184,
      -11.184,
      -11.184,
      -11.184,
      -11.184,
      -11.184,
      -11.184,
      -11.184,
      -11.184,
      -11.184,
      -11.184,
      -11.084,
      -11.184,
      -11.184,
      -11.184,
      -11.284,
      -11.384,
      -11.484,
      -11.584,
      -11.784,
      -11.984,
      -12.184,
      -12.484,
      -12.784,
      -13.084,
      -13.484,
      -13.884,
      -14.384,
      -14.784,
      -15.184,
      -15.384,
      -15.584,
      -15.784,
      -16.084,
      -16.284,
      -16.484,
      -16.684,
      -16.884,
      -17.184,
      -17.484,
      -17.684,
      -17.884,
      -17.984,
      -18.084,
      -18.084,
      -18.084,
      -18.284,
      -18.484,
      -18.584,
      -18.684,
      -18.684,
      -18.684,
      -18.684,
      -18.784,
      -18.784,
      -18.784,
      -18.784,
      -18.884,
      -18.884,
      -18.984,
      -18.984,
      -18.984,
      -19.084,
      -19.084,
      -19.084,
      -19.184,
      -18.984,
      -18.884,
      -18.784,
      -18.684,
      -18.584,
      -18.484,
      -18.384,
      -18.284,
      -18.184,
      -18.184,
      -18.084,
      -18.084,
      -18.084,
      -18.084,
      -17.984,
      -17.884,
      -17.784,
      -17.784,
      -17.684,
      -17.584,
      -17.584,
      -17.484,
      -17.484,
      -17.484,
      -17.384,
      -17.384,
      -17.284,
      -17.284,
      -17.184,
      -17.184,
      -17.084,
      -16.984,
      -16.884,
      -16.784,
      -16.684,
      -16.584,
      -16.584,
      -16.584,
      -16.384,
      -16.284,
      -16.284,
      -16.284,
      -16.384,
      -16.484,
      -16.384,
      -16.484,
      -16.484,
      -16.484,
      -16.384,
      -16.284,
      -16.084,
      -16.084,
      -16.184,
      -16.284,
      -16.284,
      -16.484,
      -16.784,
      -16.884,
      -16.784,
      -16.684,
      -16.584,
      -16.584,
      -16.584,
      -16.584,
      -16.584,
      -16.584,
      -16.584,
      -16.684,
      -16.684,
      -16.784,
      -16.884,
      -16.984,
      -17.084,
      -17.284,
      -17.384,
      -17.584,
      -17.784,
      -17.884,
      -17.984,
      -18.084,
      -17.984,
      -17.984,
      -18.284,
      -18.484,
      -18.684,
      -18.884,
      -19.084,
      -19.184,
      -18.984,
      -18.984,
      -19.084,
      -19.084,
      -18.984,
      -18.884,
      -18.684,
      -18.684,
      -18.784,
      -18.984,
      -18.984,
      -19.084,
      -19.084,
      -19.184,
      -19.384,
      -19.584,
      -19.484,
      -19.584,
      -19.884,
      -20.184,
      -20.284,
      -20.384,
      -20.584,
      -20.784,
      -20.984,
      -21.084,
      -21.084,
      -21.084,
      -21.084,
      -21.084,
      -20.984,
      -21.084,
      -21.084,
      -20.984,
      -20.784,
      -20.684,
      -20.884,
      -20.984,
      -20.784,
      -20.484,
      -20.284,
      -20.284,
      -20.284,
      -20.384,
      -20.484,
      -20.384,
      -20.384,
      -20.384,
      -20.484,
      -20.584,
      -20.584,
      -20.684,
      -20.684,
      -20.784,
      -20.784,
      -20.884,
      -20.884,
      -21.054,
      -21.024,
      -21.244,
      -21.464,
      -21.894,
      -22.144,
      -22.244,
      -22.274,
      -22.304,
      -22.324,
      -22.464,
      -22.514,
      -22.524,
      -22.544,
      -22.674,
      -22.784,
      -22.974,
      -23.184,
      -23.584,
      -23.894,
      -24.234,
      -24.454,
      -24.594,
      -24.694,
      -24.824,
      -24.924,
      -25.084,
      -25.184,
      -25.294,
      -25.364,
      -25.454,
      -25.544,
      -25.794,
      -25.904,
      -25.934,
      -25.914,
      -25.934,
      -25.914,
      -25.964,
      -25.944,
      -25.964,
      -25.914,
      -25.884,
      -25.824,
      -25.834,
      -25.814,
      -25.864,
      -25.854,
      -25.854,
      -25.814,
      -25.814,
      -25.774,
      -25.784,
      -25.744,
      -25.724,
      -25.674,
      -25.704,
      -25.674,
      -25.654,
      -25.604,
      -25.634,
      -25.574,
      -25.494,
      -25.384,
      -25.344,
      -25.244,
      -25.154,
      -25.054,
      -25.034,
      -24.964,
      -24.924,
      -24.884,
      -24.954,
      -24.964,
      -24.974,
      -24.984,
      -25.194,
      -25.204,
      -24.994,
      -24.824,
      -24.834,
      -24.794,
      -24.774,
      -24.734,
      -24.824,
      -25.004,
      -25.234,
      -25.464,
      -25.734,
      -25.944,
      -26.264,
      -26.594,
      -27.034,
      -27.514,
      -28.074,
      -28.664,
      -29.244,
      -29.714,
      -30.214,
      -30.664,
      -31.144,
      -31.584,
      -32.074,
      -32.524,
      -33.004,
      -33.434,
      -33.884,
      -34.264,
      -34.664,
      -35.004,
      -35.374,
      -35.684,
      -36.024,
      -36.324,
      -36.614,
      -36.774,
      -36.974,
      -37.104,
      -37.274,
      -37.424,
      -37.544,
      -37.524,
      -37.554,
      -37.504,
      -37.524,
      -37.514,
      -37.584,
      -37.654,
      -37.764,
      -37.844,
      -37.924,
      -37.864,
      -37.874,
      -37.834,
      -37.854,
      -37.864,
      -37.914,
      -37.904,
      -37.964,
      -37.974,
      -38.044,
      -38.074,
      -38.194,
      -38.314,
      -38.464,
      -38.594,
      -38.714,
      -38.674,
      -38.684,
      -38.634,
      -38.594,
      -38.444,
      -38.294,
      -38.084,
      -37.814,
      -37.314,
      -36.864,
      -36.374,
      -35.904,
      -35.394,
      -34.884,
      -34.274,
      -33.664,
      -32.934,
      -32.264,
      -31.564,
      -30.924,
      -30.234,
      -29.594,
      -28.904,
      -28.264,
      -27.574,
      -26.984,
      -26.454,
      -25.894,
      -25.184,
      -24.504,
      -23.734,
      -23.054,
      -22.404,
      -21.804,
      -21.194,
      -20.544,
      -19.714,
      -18.954,
      -18.184,
      -17.494,
      -16.804,
      -16.184,
      -15.544,
      -14.994,
      -14.464,
      -13.994,
      -13.514,
      -13.054,
      -12.494,
      -12.044,
      -11.644,
      -11.324,
      -11.044,
      -10.774,
      -10.404,
      -10.124,
      -9.884,
      -9.674,
      -9.394,
      -9.174,
      -8.894,
      -8.724,
      -8.634,
      -8.554,
      -8.384,
      -8.234,
      -7.934,
      -7.794,
      -7.764,
      -7.844,
      -7.964,
      -8.084,
      -8.104,
      -8.164,
      -8.144,
      -8.204,
      -8.274,
      -8.294,
      -8.234,
      -8.254,
      -8.264,
      -8.304,
      -8.244,
      -8.274,
      -8.364,
      -8.424,
      -8.314,
      -8.274,
      -8.234,
      -8.224,
      -8.184,
      -8.144,
      -7.984,
      -7.834,
      -7.574,
      -7.364,
      -7.094,
      -6.884,
      -6.624,
      -6.414,
      -6.134,
      -5.914,
      -5.644,
      -5.424,
      -5.144,
      -4.914,
      -4.634,
      -4.414,
      -4.154,
      -3.934,
      -3.684,
      -3.484,
      -3.234,
      -3.034,
      -2.804,
      -2.614,
      -2.384,
      -2.214,
      -1.994,
      -1.824,
      -1.614,
      -1.464,
      -1.254,
      -1.114,
      -0.944,
      -0.835,
      -0.668,
      -0.507,
      -0.261,
      -0.018,
  ];
  function calcLeapSeconds(thisTime) {
      let leapS;
      if (thisTime.getTime() >= leapSeconds[0].getTime()) {
        leapS = 10 + findNearestIndex(leapSeconds, thisTime);
      } else if (thisTime.getTime() >= rubberSeconds[0].getTime()) {
         firstIndex = findNearestIndex(rubberSeconds, thisTime);
         secondIndex = firstIndex + 1;
         RF = (thisTime - rubberSeconds[firstIndex]) / (rubberSeconds[secondIndex] - rubberSeconds[firstIndex]);
         leapS = ((1-RF)*rubberValues[firstIndex]) + (RF * rubberValues[secondIndex])
      } else if (thisTime.getTime() >= historicSeconds[0].getTime()) {
         firstIndex = findNearestIndex(historicSeconds, thisTime);
         secondIndex = firstIndex + 1;
         RF = (thisTime - historicSeconds[firstIndex]) / (historicSeconds[secondIndex] - historicSeconds[firstIndex]);
         leapS = ((1-RF)*historicValues[firstIndex]) + (RF * historicValues[secondIndex])
      } else {
          leapS = 12
      }
      return leapS;
  }

  function findNearestIndex(times, thisTime) {    
    const topIndex = times.length - 1;
    const topI = Math.floor(Math.log2(topIndex));      
    let midIndex = Math.ceil(topIndex / 2);
    let offIndex = Math.ceil(midIndex / 2);
    for (let i = 0; i < topI; i++) {
      if (thisTime.getTime() > times[midIndex].getTime()) {
        midIndex = midIndex + offIndex;
        if (midIndex > topIndex) {
          midIndex = topIndex
        }
      }
      if (thisTime.getTime() < times[midIndex].getTime()) {
        midIndex = midIndex - offIndex;
          if (midIndex < 0) {
            midIndex = 0
          }
      }
      offIndex = Math.ceil(offIndex / 2);
    }
    return midIndex;
  }

  function openOfficeMod(dividend, divisor) {
    let remainder = dividend % divisor;
    if ((remainder < 0 && divisor > 0) || (remainder > 0 && divisor < 0)) {
      remainder += divisor;
    }
    return remainder;
  }     
  
  const timezones = [
      { id: "tz-1", name: "Time Zone 1", default: "America/New_York" },
      { id: "tz-2", name: "Time Zone 2", default: "Europe/London" },
      { id: "tz-3", name: "Time Zone 3", default: "Asia/Tokyo" },
      { id: "tz-4", name: "Time Zone 4", default: "Australia/Sydney" }
  ];

  const fullTimeZoneList = [
      {value: "America/New_York", label: "America/New_York"},
      {value: "America/Los_Angeles", label: "America/Los_Angeles"},
      {value: "America/Chicago", label: "America/Chicago"},
      {value: "Europe/London", label: "Europe/London"},
      {value: "Europe/Paris", label: "Europe/Paris"},
      {value: "Europe/Berlin", label: "Europe/Berlin"},
      {value: "Asia/Tokyo", label: "Asia/Tokyo"},
      {value: "Asia/Shanghai", label: "Asia/Shanghai"},
      {value: "Asia/Dubai", label: "Asia/Dubai"},
      {value: "Australia/Sydney", label: "Australia/Sydney"},
      {value: "Australia/Perth", label: "Australia/Perth"},
      {value: "Pacific/Auckland", label: "Pacific/Auckland"},
      {value: "UTC", label: "UTC"},
      {value: "TAI", label: "International Atomic Time"},
      {value: "TT", label: "Terrestrial Time"}
  ];

  // Custom function to format a Date object with both date and time
  function formatTimeWithDate(date, timezone, u12hr, FSDigits) {
    const options = {
      year: 'numeric',
      month: 'long',
      day: 'numeric',
      hour12: u12hr,   
      hour: '2-digit',
      minute: '2-digit',
      second: '2-digit',
      fractionalSecondDigits: FSDigits,
      timeZone: timezone
    };
    return date.toLocaleString('en-US', options);
  }
  
  function createTimeZoneSelectors() {
    const container = document.getElementById('timezone-displays');
    timezones.forEach(tz => {
        const itemDiv = document.createElement('div');
        itemDiv.className = 'timezone-item';
        
        const label = document.createElement('label');
        label.textContent = tz.name + ":";
        
        const select = document.createElement('select');
        select.id = `select-${tz.id}`;
        
        fullTimeZoneList.forEach(zone => {
            const option = document.createElement('option');
            option.value = zone.value;
            option.textContent = zone.label;
            if (zone.value === tz.default) {
                option.selected = true;
            }
            select.appendChild(option);
        });

        const displayDiv = document.createElement('div');
        displayDiv.id = `display-${tz.id}`;
        displayDiv.style.marginLeft = '10px';
        displayDiv.textContent = 'Loading...';
        
        itemDiv.appendChild(label);
        itemDiv.appendChild(select);
        itemDiv.appendChild(displayDiv);
        container.appendChild(itemDiv);
    });
  }
  
  function updateTimestamps() {
    let now;
    let fracSecDig;
    if (timeModeSelect.value === "current") {
        now = new Date();
        fracSecDig = 1;
         use12hr = true;
    } else {
        const userTimeValue = userTimeInput.value;
        if (userTimeValue) {
            now = new Date(userTimeValue + 'Z');
            fracSecDig = 3;
            use12hr = false;
        } else {
            document.getElementById('txt').innerHTML = "<h1>Please select a time.</h1>";
            return;
        }
    }

    const TAI_UTC_OFFSET_MILLISECONDS = 1000 * calcLeapSeconds(now);

    const Pta_per_ms = 1/30550;
    const Jun_21_1998_noon_UTC = 898430400000;
    const anchor_byte3 = parseInt("8209", 16);
    const anchor_byte2 = parseInt("2800", 16);
    const anchor_byte1 = parseInt("0000", 16);

    let ms_raw = now.getTime();
    let ms_fix = (ms_raw - Jun_21_1998_noon_UTC) + TAI_UTC_OFFSET_MILLISECONDS;
    let Pta_raw = Math.round(ms_fix * Pta_per_ms * 1000) / 1000;

    let Tta_txt = "";
    let Pta_txt = "";

    if (bullysellect.value == 1) {
	    Tta_txt = Math.floor(openOfficeMod(ms_fix / 100, 10)).toString().padStart(1, '0') + " sec)";
      Pta_txt = Math.floor(openOfficeMod(ms_fix / 1000, 3055)).toString().padStart(1, '0') + ".";
    }

    if (bullysellect.value == 2) {
	    Tta_txt = Math.floor(openOfficeMod(Pta_raw * 1000, 1000)).toString().padStart(3, '0') + " %)";
      Pta_txt = Math.floor(openOfficeMod(Pta_raw, 100)).toString().padStart(2, '0') + ".";
    }

    if (bullysellect.value == 3) {
	    Tta_txt = Math.floor(openOfficeMod(Pta_raw * 1000, 1000)).toString().padStart(3, '0') + " Tta)";
      Pta_txt = Math.floor(openOfficeMod(Pta_raw, 100)).toString().padStart(2, '0') + " Pta ";
    }

    if (bullysellect.value == 4) {
	    Tta_txt = Math.floor(openOfficeMod((Pta_raw / 100) * 16**4,16**4)).toString(16).toUpperCase().padStart(4, '0') + " hex)";
      Pta_txt = "";
    }

    let Pta_dec = openOfficeMod(openOfficeMod(Pta_raw, 100) + 100, 100);
    Pta = ((Pta_raw - Pta_dec) / 100) + anchor_byte1;

    let Pta_hex1 = openOfficeMod(openOfficeMod(Pta, 16**4) + 16**4, 16**4);
    Pta = ((Pta - Pta_hex1) / 16**4) + anchor_byte2;

    let Pta_hex2 = openOfficeMod(openOfficeMod(Pta, 16**4) + 16**4, 16**4);
    let Pta_hex3 = ((Pta - Pta_hex2) / 16**4) + anchor_byte3;

    document.getElementById('txt').innerHTML =  "<h1>" 
        + Pta_hex3.toString(16).toUpperCase().padStart(4, "0") 
        + " " + Pta_hex2.toString(16).toUpperCase().padStart(4, "0") 
        + " " + Pta_hex1.toString(16).toUpperCase().padStart(4, "0")
        + " <small>(+ " + Pta_txt + Tta_txt + "</small></h1>";

    // Update each user-selected time zone
    timezones.forEach(tz => {
        const select = document.getElementById(`select-${tz.id}`);
        const display = document.getElementById(`display-${tz.id}`);
        const selectedTimezone = select.value;

        if (selectedTimezone === 'TAI') {
            const taiTime = new Date(now.getTime() + TAI_UTC_OFFSET_MILLISECONDS);
            display.textContent = `${formatTimeWithDate(taiTime, 'UTC', use12hr, fracSecDig)} (TAI)`;
        } else if (selectedTimezone === 'TT') {
            const taiTime = new Date(now.getTime() + TAI_UTC_OFFSET_MILLISECONDS);
            const ttTime = new Date(taiTime.getTime() + TT_TAI_OFFSET_MILLISECONDS);
            display.textContent = `${formatTimeWithDate(ttTime, 'UTC', use12hr, fracSecDig)} (TT)`;
        } else {
            display.textContent = formatTimeWithDate(now, selectedTimezone, use12hr, fracSecDig);
        }
    });

    if (timeModeSelect.value === "current") {
        animationFrameId = requestAnimationFrame(updateTimestamps);
    }
  }

  function handleTimeModeChange() {
      if (timeModeSelect.value === "user-selected") {
          userTimeInput.style.display = "block";
          if (animationFrameId) {
              cancelAnimationFrame(animationFrameId);
              animationFrameId = null;
          }
          updateTimestamps();
      } else {
          userTimeInput.style.display = "none";
          updateTimestamps();
      }
  }
  
  function initTimestamps() {
    createTimeZoneSelectors();
    updateTimestamps();

    // Event listeners
    timeModeSelect.addEventListener('change', handleTimeModeChange);
    userTimeInput.addEventListener('change', updateTimestamps);
    bullysellect.addEventListener('change', updateTimestamps);
  }

  function createTimeZoneSelectors() {
    const container = document.getElementById('timezone-displays');
    timezones.forEach(tz => {
        const itemDiv = document.createElement('div');
        itemDiv.className = 'timezone-item';
        
        const label = document.createElement('label');
        label.textContent = tz.name + ":";
        
        const select = document.createElement('select');
        select.id = `select-${tz.id}`;
        
        fullTimeZoneList.forEach(zone => {
            const option = document.createElement('option');
            option.value = zone.value;
            option.textContent = zone.label;
            if (zone.value === tz.default) {
                option.selected = true;
            }
            select.appendChild(option);
        });

        const displayDiv = document.createElement('div');
        displayDiv.id = `display-${tz.id}`;
        displayDiv.style.marginLeft = '10px';
        displayDiv.textContent = 'Loading...';
        
        itemDiv.appendChild(label);
        itemDiv.appendChild(select);
        itemDiv.appendChild(displayDiv);
        container.appendChild(itemDiv);
    });
  }

  </script>
</body>
</html>
